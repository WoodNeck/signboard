{"version":3,"file":"signboard.js","sources":["../src/core/SignBoardError.ts","../src/const/vertex.ts","../src/const/error.ts","../src/const/event.ts","../src/const/options.ts","../src/utils.ts","../src/core/Renderer.ts","../src/texture/ImageTexture.ts","../src/texture/VideoTexture.ts","../src/texture/TextTexture.ts","../src/core/TextureLoader.ts","../src/SignBoard.ts","../src/index.umd.ts"],"sourcesContent":["/**\n * Special type of known error that {@link SignBoard} throws.\n * @property {number} code Error code\n * @property {string} message Error message\n * @see {@link ERROR_CODE ERROR_CODE}\n */\nclass SignBoardError extends Error {\n  public readonly code: number;\n\n  /**\n   * @param message Error message\n   * @param code Error code\n   */\n  constructor(message: string, code: number) {\n    super(`(signboard.js) ${message}`);\n    Object.setPrototypeOf(this, SignBoardError.prototype);\n    this.name = \"SignBoardError\";\n    this.code = code;\n  }\n}\n\nexport default SignBoardError;\n","export const POSITION = new Float32Array([\n  -1, -1,\n  1, -1,\n  -1, 1,\n  -1, 1,\n  1, -1,\n  1, 1\n]);\n\nexport const TEX_COORD = new Float32Array([\n  0, 1,\n  1, 1,\n  0, 0,\n  0, 0,\n  1, 1,\n  1, 0\n]);\n","/**\n * Error codes of {@link SignBoardError}\n * @name ERROR_CODE\n * @constant\n * @type {object}\n * @property {number} WRONG_TYPE 0\n * @property {number} WRONG_OPTION 1\n * @property {number} ELEMENT_NOT_FOUND 2\n * @property {number} CANVAS_NOT_FOUND 3\n * @property {number} WEBGL_NOT_SUPPORTED 4\n * @property {number} FAILED_COMPILE_SHADER 5\n * @property {number} FAILED_COMPILE_PROGRAM 6\n * @property {number} FAILED_TO_LOAD_IMAGE 7\n * @property {number} TEXTURE_NOT_INITIALIZED 8\n */\nexport const CODE: {\n  [key in keyof typeof MESSAGE]: number;\n} = {\n  WRONG_TYPE: 0,\n  WRONG_OPTION: 1,\n  ELEMENT_NOT_FOUND: 2,\n  ELEMENT_NOT_CANVAS: 3,\n  WEBGL_NOT_SUPPORTED: 4,\n  FAILED_COMPILE_SHADER: 5,\n  FAILED_COMPILE_PROGRAM: 6,\n  FAILED_TO_LOAD_IMAGE: 7,\n  TEXTURE_NOT_INITIALIZED: 8\n};\n\nexport const MESSAGE = {\n  WRONG_TYPE: (val: any, types: string[]) => `${val}(${typeof val}) is not a ${types.map(type => `\"${type}\"`).join(\" or \")}.`,\n  WRONG_OPTION: (val: any, optionName: string, possible: any[]) => `Given value(${val}, ${typeof val}) can't be used for option \"${optionName}\". Possible values are: ${possible.join(\", \")}`,\n  ELEMENT_NOT_FOUND: (query: string) => `Element with selector \"${query}\" not found.`,\n  ELEMENT_NOT_CANVAS: (el: HTMLElement) => `Given element <${el.tagName}> is not a canvas.`,\n  WEBGL_NOT_SUPPORTED: (msg: string) => `WebGL context creation failed with the following error - \"${msg}\"`,\n  FAILED_COMPILE_SHADER: (msg: string | null) => `Failed compiling shader - \"${msg}\"`,\n  FAILED_COMPILE_PROGRAM: (msg: string | null) => `Failed compiling WebGL program - \"${msg}\"`,\n  FAILED_TO_LOAD_IMAGE: (src: string) => `Failed to load image with src - \"${src}\"`,\n  TEXTURE_NOT_INITIALIZED: \"Texture is not initialized yet\"\n};\n","export const BROWSER = {\n  WEBGL_CONTEXT_CREATION_ERROR: \"webglcontextcreationerror\",\n  LOAD: \"load\",\n  ERROR: \"error\",\n  RESIZE: \"resize\",\n  READY_STATE_CHANGE: \"readystatechange\",\n  CAN_PLAY_THROUGH: \"canplaythrough\",\n  LOADED_DATA: \"loadeddata\"\n};\n","/**\n * A constant for the {@link SignBoard#contentType contentType} option\n * @type {object}\n * @property {string} IMAGE \"image\"\n * @property {string} VIDEO \"video\"\n * @property {string} TEXT \"text\"\n * @example\n * ```ts\n * import { CONTENT_TYPE } from \"signboard\";\n * ```\n */\nexport const CONTENT_TYPE = {\n  IMAGE: \"image\",\n  VIDEO: \"video\",\n  TEXT: \"text\"\n} as const;\n\n/**\n * A constant for the {@link SignBoard#objectFit objectFit} option\n * @type {object}\n * @property {string} FILL \"fill\"\n * @property {string} CONTAIN \"contain\"\n * @property {string} COVER \"cover\"\n * @property {string} NONE \"none\"\n * @property {string} SCALE_DOWN \"scale-down\"\n * @example\n * ```ts\n * import { OBJECT_FIT } from \"signboard\";\n * ```\n */\nexport const OBJECT_FIT = {\n  FILL: \"fill\",\n  CONTAIN: \"contain\",\n  COVER: \"cover\",\n  NONE: \"none\",\n  SCALE_DOWN: \"scale-down\"\n} as const;\n","import SignBoardError from \"./core/SignBoardError\";\nimport * as EVENT from \"./const/event\";\nimport * as ERROR from \"./const/error\";\nimport { Merged, ValueOf } from \"./types\";\nimport { CONTENT_TYPE, OBJECT_FIT } from \"./const/options\";\n\nexport function getElement(el: HTMLElement | string | null): HTMLElement | null {\n  let targetEl: HTMLElement | null = null;\n\n  if (typeof el === \"string\") {\n    const queryResult = document.querySelector(el);\n    if (!queryResult) {\n      throw new SignBoardError(ERROR.MESSAGE.ELEMENT_NOT_FOUND(el), ERROR.CODE.ELEMENT_NOT_FOUND);\n    }\n    targetEl = queryResult as HTMLElement;\n  } else if (el && el.nodeType === Node.ELEMENT_NODE) {\n    targetEl = el;\n  }\n\n  return targetEl;\n}\n\nexport const getCanvas = (el: HTMLElement | string): HTMLCanvasElement => {\n  const targetEl = getElement(el);\n\n  if (!targetEl) {\n    throw new SignBoardError(ERROR.MESSAGE.WRONG_TYPE(el, [\"HTMLElement\", \"string\"]), ERROR.CODE.WRONG_TYPE);\n  }\n\n  if (!/^canvas$/i.test(targetEl.tagName)) {\n    throw new SignBoardError(ERROR.MESSAGE.ELEMENT_NOT_CANVAS(targetEl), ERROR.CODE.ELEMENT_NOT_CANVAS);\n  }\n\n  return targetEl as HTMLCanvasElement;\n}\n\nexport const getWebGLContext = (canvas: HTMLCanvasElement): WebGLRenderingContext => {\n  let context: WebGLRenderingContext | null = null;\n  let reason: string = \"\";\n  const contextAttributes: WebGLContextAttributes = {};\n\n  const onWebGLContextCreationError = (e: Event) => {\n    reason = (e as WebGLContextEvent).statusMessage || \"Unknown Error\";\n  }\n\n  canvas.addEventListener(EVENT.BROWSER.WEBGL_CONTEXT_CREATION_ERROR, onWebGLContextCreationError);\n  context = canvas.getContext(\"webgl\", contextAttributes) || canvas.getContext(\"experimental-webgl\") as WebGLRenderingContext;\n  canvas.removeEventListener(EVENT.BROWSER.WEBGL_CONTEXT_CREATION_ERROR, onWebGLContextCreationError);\n\n  if (!context) throw new SignBoardError(ERROR.MESSAGE.WEBGL_NOT_SUPPORTED(reason), ERROR.CODE.WEBGL_NOT_SUPPORTED);\n\n  canvas.addEventListener(\"webglcontextlost\", e => {\n    e.preventDefault();\n  }, false);\n\n  return context;\n}\n\nexport const merge = <From extends {[key: string]: any}, To extends {[key: string]: any}>(target: From, ...sources: To[]): Merged<From, To> => {\n  sources.forEach(source => {\n    Object.keys(source).forEach(key => {\n      (target as any)[key] = source[key];\n    });\n  });\n\n  return target as Merged<From, To>;\n};\n\nexport const clamp = (x: number, min: number, max: number) => Math.max(Math.min(x, max), min);\n\nexport const getSubImage = (\n  contentSize: { width: number; height: number },\n  renderingSize: { width: number; height: number },\n  objectFit: ValueOf<typeof OBJECT_FIT>,\n  contentType: ValueOf<typeof CONTENT_TYPE>\n): { x: number; y: number; width: number; height: number } => {\n  switch (objectFit) {\n    case OBJECT_FIT.FILL: {\n      return { x: 0, y: 0, ...renderingSize }\n    }\n    case OBJECT_FIT.CONTAIN: {\n      const xScale = renderingSize.width / contentSize.width;\n      const yScale = renderingSize.height / contentSize.height;\n\n      if (xScale >= yScale) {\n        const newWidth = contentSize.width * yScale\n        return { x: (renderingSize.width - newWidth) / 2, y: 0, width: newWidth, height: renderingSize.height };\n      } else {\n        const newHeight = contentSize.height * xScale;\n        return { x: 0, y: (renderingSize.height - newHeight) / 2, width: renderingSize.width, height: newHeight };\n      }\n    }\n    case OBJECT_FIT.COVER: {\n      const xScale = renderingSize.width / contentSize.width;\n      const yScale = renderingSize.height / contentSize.height;\n\n      if (xScale >= yScale) {\n        const newHeight = contentSize.height * xScale;\n        return { x: 0, y: (renderingSize.height - newHeight) / 2, width: renderingSize.width, height: newHeight };\n      } else {\n        const newWidth = contentSize.width * yScale\n        const xOffset = contentType === CONTENT_TYPE.TEXT\n          ? 0\n          : (renderingSize.width - newWidth) / 2;\n\n        return { x: xOffset, y: 0, width: newWidth, height: renderingSize.height };\n      }\n    }\n    case OBJECT_FIT.NONE: {\n      return { x: (renderingSize.width - contentSize.width) / 2, y: (renderingSize.height - contentSize.height) / 2, ...contentSize };\n    }\n    case OBJECT_FIT.SCALE_DOWN: {\n      if (contentSize.width > renderingSize.width || contentSize.height > renderingSize.height) {\n        return getSubImage(contentSize, renderingSize, OBJECT_FIT.CONTAIN, contentType);\n      } else {\n        return getSubImage(contentSize, renderingSize, OBJECT_FIT.NONE, contentType);\n      }\n    }\n    default:\n      throw new SignBoardError(\n        ERROR.MESSAGE.WRONG_OPTION(objectFit, \"objectFit\", Object.keys(OBJECT_FIT).map(key => OBJECT_FIT[key as keyof typeof OBJECT_FIT])),\n        ERROR.CODE.WRONG_OPTION\n      )\n  }\n}\n\nexport const parsePadding = (padding: number | number[]) => {\n  if (!Array.isArray(padding)) {\n    return [padding, padding, padding, padding];\n  } else if (padding.length === 2) {\n    return [padding[0], padding[1], padding[0], padding[1]];\n  } else if (padding.length === 4) {\n    return padding;\n  } else {\n    throw new SignBoardError(\n      ERROR.MESSAGE.WRONG_OPTION(padding, \"textPadding\", [\"number\", \"[number, number]\", \"[number, number, number, number]\"]),\n      ERROR.CODE.WRONG_OPTION\n    )\n  }\n}\n","import SignBoardError from \"./SignBoardError\";\nimport SignBoard from \"../SignBoard\";\nimport Texture from \"../texture/Texture\";\nimport signboardVS from \"../shader/signboard.vert\";\nimport signboardFS from \"../shader/signboard.frag\";\nimport * as VERTEX from \"../const/vertex\";\nimport * as ERROR from \"../const/error\";\nimport { getSubImage, getWebGLContext } from \"../utils\";\n\nclass Renderer {\n  private _signboard: SignBoard;\n  private _canvas: HTMLCanvasElement;\n  private _gl: WebGLRenderingContext;\n  private _program: WebGLProgram | null;\n  private _buffers: {\n    position: WebGLBuffer | null,\n    texcoord: WebGLBuffer | null\n  }\n  private _uniforms: {\n    uInvTileSize: WebGLUniformLocation | null,\n    uResolution: WebGLUniformLocation | null,\n    uEmission: WebGLUniformLocation | null,\n    uDissipation: WebGLUniformLocation | null,\n    uBulbSize: WebGLUniformLocation | null,\n    uTexOffset: WebGLUniformLocation | null,\n    uTexScale: WebGLUniformLocation | null,\n    uScrollOffset: WebGLUniformLocation | null\n  }\n  private _texture: Texture | null;\n  private _lastRenderTime: number;\n  private _animationID: number;\n  private _prevScroll: number;\n  private _contextLost: boolean;\n\n  public get animating() { return this._animationID >= 0; }\n\n  // Options\n  public get canvas() { return this._canvas; }\n  public get gl() { return this._gl; }\n\n  public constructor(canvas: HTMLCanvasElement, signboard: SignBoard) {\n    this._signboard = signboard;\n    this._canvas = canvas;\n    this._gl = getWebGLContext(canvas);\n    this._program = null;\n    this._texture = null;\n    this._lastRenderTime = -1;\n    this._animationID = -1;\n    this._prevScroll = 0;\n    this._buffers = {\n      position: null,\n      texcoord: null\n    }\n    this._uniforms = {\n      uInvTileSize: null,\n      uResolution: null,\n      uEmission: null,\n      uDissipation: null,\n      uBulbSize: null,\n      uTexOffset: null,\n      uTexScale: null,\n      uScrollOffset: null\n    };\n    this._contextLost = false;\n  }\n\n  public destroy() {\n    this.stop();\n\n    const gl = this._gl;\n    const texture = this._texture?.webGLTexture;\n\n    gl.deleteProgram(this._program);\n\n    gl.deleteBuffer(this._buffers.position);\n    gl.deleteBuffer(this._buffers.texcoord);\n\n    if (texture) {\n      gl.deleteTexture(texture);\n    }\n\n    gl.getExtension(\"WEBGL_lose_context\")?.loseContext();\n\n    this._texture = null;\n    this._contextLost = true;\n  }\n\n  public init() {\n    if (this._contextLost) return;\n\n    const gl = this._gl;\n    const program = this._createWebGLProgram();\n\n    this._program = program;\n\n    gl.useProgram(program);\n    this._bindAttributes(program);\n    this._bindUniforms(program);\n    this.updateUniforms();\n  }\n\n  public setTexture(texture: Texture) {\n    texture.init(this._gl);\n    this._texture = texture;\n    this.updateTextureOffset();\n  }\n\n  public resize() {\n    const canvas = this._canvas;\n\n    canvas.width = canvas.clientWidth;\n    canvas.height = canvas.clientHeight;\n\n    this.updateUniforms();\n  }\n\n  /**\n   */\n  public start() {\n    this._animationID = requestAnimationFrame(this._onAnimationFrame);\n  }\n\n  /**\n   * Stop animation\n   */\n  public stop() {\n    cancelAnimationFrame(this._animationID);\n    this._animationID = -1;\n    this._lastRenderTime = -1;\n  }\n\n  /**\n   * Render a single frame\n   */\n  public render() {\n    const gl = this._gl;\n    const texture = this._texture;\n\n    if (!this._signboard.initialized) return;\n\n    if (!texture) {\n      throw new SignBoardError(ERROR.MESSAGE.TEXTURE_NOT_INITIALIZED, ERROR.CODE.TEXTURE_NOT_INITIALIZED);\n    }\n\n    texture.upload(this._gl);\n\n    gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    gl.drawArrays(gl.TRIANGLES, 0, 6);\n    gl.bindTexture(gl.TEXTURE_2D, null);\n  }\n\n  public updateUniforms() {\n    const signboard = this._signboard;\n    const gl = this._gl;\n    const canvas = this._canvas;\n    const uniforms = this._uniforms;\n\n    if (!this._program) return;\n\n    gl.uniform1f(uniforms.uInvTileSize, 1 / signboard.tileSize);\n    gl.uniform2f(uniforms.uResolution, canvas.width, canvas.height);\n    gl.uniform1f(uniforms.uEmission, signboard.emission);\n    gl.uniform1f(uniforms.uDissipation, 1 / signboard.dissipation);\n    gl.uniform1f(uniforms.uBulbSize, signboard.bulbSize);\n\n    if (this._texture) {\n      this.updateTextureOffset();\n    }\n  }\n\n  public updateTextureOffset() {\n    const signboard = this._signboard;\n    const gl = this._gl;\n    const texture = this._texture;\n    const uniforms = this._uniforms;\n\n    if (!texture) {\n      throw new SignBoardError(ERROR.MESSAGE.TEXTURE_NOT_INITIALIZED, ERROR.CODE.TEXTURE_NOT_INITIALIZED);\n    }\n\n    const renderingSize = { width: gl.drawingBufferWidth, height: gl.drawingBufferHeight };\n    const subImage = getSubImage(texture.size, renderingSize, signboard.objectFit, signboard.contentType);\n\n    gl.uniform2f(uniforms.uTexOffset, subImage.x / renderingSize.width, subImage.y / renderingSize.height);\n    gl.uniform2f(uniforms.uTexScale, renderingSize.width / subImage.width, renderingSize.height / subImage.height);\n  }\n\n  private _onAnimationFrame = (time: number) => {\n    const signboard = this._signboard;\n    const lastTime = this._lastRenderTime;\n    const delta = time - lastTime;\n    const updateInterval = 1000 / signboard.frameRate;\n\n    if (delta >= updateInterval || lastTime < 0) {\n      this._increaseScrollOffset();\n      this.render();\n      this._lastRenderTime = lastTime + updateInterval;\n    }\n\n    this._animationID = requestAnimationFrame(this._onAnimationFrame);\n  }\n\n  private _compileShader(src: string, type: WebGLRenderingContextBase[\"VERTEX_SHADER\"] | WebGLRenderingContextBase[\"FRAGMENT_SHADER\"]) {\n    const gl = this._gl;\n    const shader = gl.createShader(type);\n\n    if (!shader) {\n      throw new SignBoardError(ERROR.MESSAGE.FAILED_COMPILE_SHADER(`Unexpected Error: ${gl.getError()}`), ERROR.CODE.FAILED_COMPILE_SHADER);\n    }\n\n    gl.shaderSource(shader, src);\n    gl.compileShader(shader);\n\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n      throw new SignBoardError(ERROR.MESSAGE.FAILED_COMPILE_SHADER(gl.getShaderInfoLog(shader)), ERROR.CODE.FAILED_COMPILE_SHADER);\n    }\n\n    return shader;\n  }\n\n  private _createWebGLProgram() {\n    const gl = this._gl;\n\n    const program = gl.createProgram()!;\n    const vs = this._compileShader(signboardVS, gl.VERTEX_SHADER);\n    const fs = this._compileShader(signboardFS, gl.FRAGMENT_SHADER);\n\n    gl.attachShader(program, vs);\n    gl.attachShader(program, fs);\n    gl.linkProgram(program);\n\n    if (!gl.getProgramParameter( program, gl.LINK_STATUS)) {\n      throw new SignBoardError(ERROR.MESSAGE.FAILED_COMPILE_PROGRAM(gl.getProgramInfoLog(program)), ERROR.CODE.FAILED_COMPILE_PROGRAM);\n    }\n\n    return program;\n  }\n\n  private _bindAttributes(program: WebGLProgram) {\n    const gl = this._gl;\n    const positionLocation = gl.getAttribLocation(program, \"aPosition\");\n    const texcoordLocation = gl.getAttribLocation(program, \"aTexCoord\");\n\n    const positionBuffer = gl.createBuffer();\n    const texcoordBuffer = gl.createBuffer();\n\n    this._buffers.position = positionBuffer;\n    this._buffers.texcoord = texcoordBuffer;\n\n    gl.enableVertexAttribArray(positionLocation);\n    gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, VERTEX.POSITION, gl.STATIC_DRAW);\n    gl.vertexAttribPointer(positionLocation, 2, gl.FLOAT, false, 0, 0);\n\n    gl.enableVertexAttribArray(texcoordLocation);\n    gl.bindBuffer(gl.ARRAY_BUFFER, texcoordBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, VERTEX.TEX_COORD, gl.STATIC_DRAW);\n    gl.vertexAttribPointer(texcoordLocation, 2, gl.FLOAT, false, 0, 0);\n  }\n\n  private _bindUniforms(program: WebGLProgram) {\n    const gl = this._gl;\n    const uniforms = this._uniforms;\n\n    for (const key in uniforms) {\n      uniforms[key as keyof typeof uniforms] = gl.getUniformLocation(program, key);\n    }\n  }\n\n  private _increaseScrollOffset() {\n    const signboard = this._signboard;\n    const gl = this._gl;\n    const texture = this._texture;\n    const uniforms = this._uniforms;\n    const scrollSpeed = signboard.scrollSpeed;\n\n    if (scrollSpeed === 0) return;\n\n    if (!texture) {\n      throw new SignBoardError(ERROR.MESSAGE.TEXTURE_NOT_INITIALIZED, ERROR.CODE.TEXTURE_NOT_INITIALIZED);\n    }\n\n    const prevVal = this._prevScroll;\n    const newVal = prevVal + scrollSpeed * (1000 / signboard.frameRate) / gl.drawingBufferWidth;\n\n    this._prevScroll = newVal;\n\n    gl.uniform1f(uniforms.uScrollOffset, newVal);\n  }\n}\n\nexport default Renderer;\n","import Texture from \"./Texture\";\n\nclass ImageTexture implements Texture {\n  private _image: HTMLImageElement;\n  private _texture: WebGLTexture | null;\n\n  public get webGLTexture() { return this._texture; }\n  public get size() { return {\n    width: this._image.naturalWidth,\n    height: this._image.naturalHeight\n  }}\n\n  public constructor(image: HTMLImageElement) {\n    this._image = image;\n    this._texture = null;\n  }\n\n  public init(gl: WebGLRenderingContext) {\n    this._texture = gl.createTexture();\n  }\n\n  public upload(gl: WebGLRenderingContext) {\n    gl.bindTexture(gl.TEXTURE_2D, this._texture);\n\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, this._image);\n  }\n\n  public update(src?: string) {\n    if (!src) return;\n\n    this._image.src = src;\n  }\n}\n\nexport default ImageTexture;\n","import Texture from \"./Texture\";\n\nclass VideoTexture implements Texture {\n  private _video: HTMLVideoElement;\n  private _texture: WebGLTexture | null;\n\n  public get webGLTexture() { return this._texture; }\n  public get size() { return {\n    width: this._video.videoWidth,\n    height: this._video.videoHeight\n  }}\n\n  public constructor(video: HTMLVideoElement) {\n    this._video = video;\n    this._texture = null;\n  }\n\n  public init(gl: WebGLRenderingContext) {\n    this._texture = gl.createTexture();\n    this._video.play();\n  }\n\n  public upload(gl: WebGLRenderingContext) {\n    gl.bindTexture(gl.TEXTURE_2D, this._texture);\n\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, this._video);\n  }\n\n  public update(src?: string) {\n    if (!src) return;\n\n    const video = this._video;\n\n    video.src = src;\n    video.play();\n  }\n}\n\nexport default VideoTexture;\n","import SignBoard, { SignBoardOptions } from \"../SignBoard\";\nimport { parsePadding } from \"../utils\";\nimport Texture from \"./Texture\";\n\nclass TextTexture implements Texture {\n  private _signboard: SignBoard;\n  private _canvas: HTMLCanvasElement;\n  private _context: CanvasRenderingContext2D;\n  private _texture: WebGLTexture | null;\n\n  public get webGLTexture() { return this._texture; }\n  public get size() { return {\n    width: this._canvas.width,\n    height: this._canvas.height\n  }}\n\n  public constructor(signboard: SignBoard) {\n    this._signboard = signboard;\n    this._canvas = document.createElement(\"canvas\");\n    this._context = this._canvas.getContext(\"2d\")!;\n    this._texture = null;\n  }\n\n  public init(gl: WebGLRenderingContext) {\n    const signboard = this._signboard;\n    const text = signboard.src;\n\n    this._texture = gl.createTexture();\n\n    this._drawText(text);\n  }\n\n  public update(src?: string) {\n    const canvas = this._canvas;\n\n    this._context.clearRect(0, 0, canvas.width, canvas.height);\n    this._drawText(src ?? this._signboard.src);\n  }\n\n  public upload(gl: WebGLRenderingContext) {\n    gl.bindTexture(gl.TEXTURE_2D, this._texture);\n\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, this._canvas);\n  }\n\n  private _drawText(text: string) {\n    const canvas = this._canvas;\n    const context = this._context;\n    const signboard = this._signboard;\n    const options = this._getDrawingOptions();\n\n    for (const key in options) {\n      (context as any)[key] = (options as any)[key];\n    }\n\n    const textPadding = parsePadding(signboard.textPadding);\n    const textSize = context.measureText(text);\n\n    canvas.width = textSize.actualBoundingBoxRight - textSize.actualBoundingBoxLeft\n      + textPadding[1] + textPadding[3];\n    canvas.height = (textSize.actualBoundingBoxDescent - textSize.actualBoundingBoxAscent)\n      + textPadding[0] + textPadding[2];\n\n    for (const key in options) {\n      (context as any)[key] = (options as any)[key];\n    }\n\n    context.fillText(text, textPadding[3], textPadding[0]);\n  }\n\n  private _getDrawingOptions() {\n    const signboard = this._signboard;\n\n    return {\n      font: \"32pt serif\",\n      textAlign: \"left\",\n      fillStyle: \"red\",\n      textBaseline: \"top\",\n      ...signboard.textOptions\n    } as Required<SignBoardOptions[\"textOptions\"]>;\n  }\n}\n\nexport default TextTexture;\n","import SignBoardError from \"./SignBoardError\";\nimport SignBoard from \"../SignBoard\";\nimport * as ERROR from \"../const/error\";\nimport { BROWSER } from \"../const/event\";\nimport { CONTENT_TYPE } from \"../const/external\";\nimport Texture from \"../texture/Texture\";\nimport ImageTexture from \"../texture/ImageTexture\";\nimport VideoTexture from \"../texture/VideoTexture\";\nimport TextTexture from \"../texture/TextTexture\";\nimport { Attributes } from \"../types\";\n\nclass TextureLoader {\n  private _signboard: SignBoard;\n\n  public constructor(signboard: SignBoard) {\n    this._signboard = signboard;\n  }\n\n  public async load(): Promise<Texture> {\n    const type = this._signboard.contentType;\n\n    switch (type) {\n      case CONTENT_TYPE.IMAGE:\n        return this._loadImage();\n      case CONTENT_TYPE.VIDEO:\n        return this._loadVideo();\n      case CONTENT_TYPE.TEXT:\n        return new TextTexture(this._signboard);\n      default:\n        throw new SignBoardError(\n          ERROR.MESSAGE.WRONG_OPTION(type, \"contentType\", Object.keys(CONTENT_TYPE).map(key => CONTENT_TYPE[key as keyof typeof CONTENT_TYPE])),\n          ERROR.CODE.WRONG_OPTION\n        )\n    }\n  }\n\n  private async _loadImage(): Promise<ImageTexture> {\n    const signboard = this._signboard;\n    const image = new Image();\n    const src = signboard.src;\n\n    return new Promise((resolve, reject) => {\n      image.addEventListener(BROWSER.LOAD, () => {\n        resolve(new ImageTexture(image));\n      });\n      image.addEventListener(BROWSER.ERROR, () => {\n        reject(new SignBoardError(ERROR.MESSAGE.FAILED_TO_LOAD_IMAGE(src), ERROR.CODE.FAILED_TO_LOAD_IMAGE));\n      });\n\n      const attribs = {\n        crossOrigin: \"anonymous\",\n        ...signboard.contentAttribs\n      } as Attributes<HTMLImageElement>;\n\n      for (const key in attribs) {\n        image.setAttribute(key, (attribs as any)[key]);\n      }\n\n      image.src = src;\n    });\n  }\n\n  private async _loadVideo(): Promise<VideoTexture> {\n    const signboard = this._signboard;\n    const video = document.createElement(\"video\");\n    const src = signboard.src;\n\n    return new Promise((resolve, reject) => {\n      video.addEventListener(BROWSER.LOADED_DATA, () => {\n        resolve(new VideoTexture(video));\n      });\n      video.addEventListener(BROWSER.ERROR, () => {\n        reject(new SignBoardError(ERROR.MESSAGE.FAILED_TO_LOAD_IMAGE(src), ERROR.CODE.FAILED_TO_LOAD_IMAGE));\n      });\n\n      const attribs = {\n        loop: true,\n        playsInline: true,\n        autoplay: true,\n        muted: true,\n        crossOrigin: \"anonymous\",\n        ...signboard.contentAttribs\n      } as Attributes<HTMLVideoElement>;\n\n      for (const key in attribs) {\n        video.setAttribute(key, (attribs as any)[key]);\n      }\n\n      video.src = src;\n    });\n  }\n}\n\nexport default TextureLoader;\n","import SignBoardError from \"./core/SignBoardError\";\nimport Renderer from \"./core/Renderer\";\nimport TextureLoader from \"./core/TextureLoader\";\nimport { Texture } from \"./texture\";\nimport { BROWSER } from \"./const/event\";\nimport { getCanvas } from \"./utils\";\nimport * as ERROR from \"./const/error\";\nimport { CONTENT_TYPE, OBJECT_FIT } from \"./const/options\";\nimport { Attributes, ValueOf } from \"./types\";\n\n/**\n * @interface\n * @param {\"image\" | \"video\" | \"text\"} [contentType=\"image\"] A type of content\n * @param {object} [contentAttribs={}] Additional attributes for image / video element (if you need it)\n * @param {number} [frameRate=60] A number of rendering frames per second for video / text\n * @param {boolean} [autoResize=true] Enabling this option will make SignBoard to call `resize` whenever window's `resize` event is triggered\n * @param {boolean} [autoInit=true] If `false` is given, SignBoard will not automatically initialize immediately after creating instance\n * @param {number} [tileSize=8] A size of each tile blocks, in px\n * @param {number} [emission=1.5] LED light emission modifier, bigger the brighter. `emission: 1` will render the original color of the contents\n * @param {number} [dissipation=0.5] A value indicating how fast light fades out from the center of each tiles\n * @param {number} [bulbSize=0.7] A lightbulb's size inside each tiles\n * @param {string} [objectFit=\"fill\"] The object-fit CSS property sets how the content of a replaced element, such as an <img\\> or <video\\>, should be resized to fit its container.<br/>See https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit for details\n * @param {object} [textOptions={}] Canvas's 2D context attributes for customizing texts\n * @param {number | Array<number>} [textPadding=0] A padding values that will be used for rendering text\n * @param {number} [scrollSpeed=0] A horizontal scroll speed (right to left)\n * @param {boolean} [initOnFontLoad=false] A option that can be used when you're using a custom font that should be loaded before initializing.<br/>Enabling this option will make SignBoard to call `init` after when the font described in `textOptions.font` is loaded.\n */\nexport interface SignBoardOptions {\n  contentType: ValueOf<typeof CONTENT_TYPE>;\n  contentAttribs: Partial<Attributes<HTMLImageElement> | Attributes<HTMLMediaElement>>;\n  frameRate: number;\n  autoResize: boolean;\n  autoInit: boolean;\n  tileSize: number;\n  emission: number;\n  dissipation: number;\n  bulbSize: number;\n  objectFit: ValueOf<typeof OBJECT_FIT>;\n  textOptions: Partial<Attributes<CanvasRenderingContext2D>>;\n  textPadding: number | number[];\n  scrollSpeed: number;\n  initOnFontLoad: boolean | [boolean, string];\n}\n\n/**\n * WebGL-based LED SignBoard effect for image / video / text\n */\nclass SignBoard {\n  private _renderer: Renderer;\n  private _texture: Texture | null;\n  private _src: string;\n  private _initialized: boolean;\n\n  // Options\n  private _contentType: SignBoardOptions[\"contentType\"];\n  private _contentAttribs: SignBoardOptions[\"contentAttribs\"];\n  private _autoResize: boolean;\n  private _autoInit: boolean;\n  private _frameRate: number;\n  private _tileSize: number;\n  private _emission: number;\n  private _dissipation: number;\n  private _bulbSize: number;\n  private _objectFit: ValueOf<typeof OBJECT_FIT>;\n  private _initOnFontLoad: SignBoardOptions[\"initOnFontLoad\"];\n  private _textOptions: SignBoardOptions[\"textOptions\"];\n  private _textPadding: SignBoardOptions[\"textPadding\"];\n  private _scrollSpeed: number;\n\n  public get renderer() { return this._renderer; }\n  /**\n   * Current src of the image/video, or text string when the `contentType` is \"text\"\n   * @type {string}\n   * @readonly\n   */\n  public get src() { return this._src; }\n  /**\n   * Whether the {@link SignBoard#init} is called\n   * @type {boolean}\n   * @readonly\n   */\n  public get initialized() { return this._initialized; }\n  public get texture() { return this._texture; }\n\n  // Options\n  /**\n   * Current value of the `contentType` option\n   * @see {@link SignBoardOptions}\n   */\n  public get contentType() { return this._contentType; }\n  public set contentType(val: SignBoardOptions[\"contentType\"]) { this._contentType = val; }\n  /**\n   * Current value of the `contentAttribs` option\n   * @see {@link SignBoardOptions}\n   */\n  public get contentAttribs() { return this._contentAttribs; }\n  public set contentAttribs(val: SignBoardOptions[\"contentAttribs\"]) { this._contentAttribs = val; }\n  /**\n   * Current value of the `autoResize` option\n   * @see {@link SignBoardOptions}\n   */\n  public get autoResize() { return this._autoResize; }\n  public set autoResize(val: boolean) { this._updateAutoResize(val); }\n  /**\n   * Current value of the `autoInit` option\n   * @see {@link SignBoardOptions}\n   * @readonly\n   */\n  public get autoInit() { return this._autoInit; }\n  /**\n   * Current value of the `frameRate` option\n   * @see {@link SignBoardOptions}\n   */\n  public get frameRate() { return this._frameRate; }\n  public set frameRate(val: number) { this._frameRate = val; }\n  /**\n   * Current value of the `tileSize` option\n   * @see {@link SignBoardOptions}\n   */\n  public get tileSize() { return this._tileSize; }\n  public set tileSize(val: number) {\n    this._tileSize = val;\n    this._renderer.updateUniforms();\n    this._renderer.render();\n  }\n  /**\n   * Current value of the `emission` option\n   * @see {@link SignBoardOptions}\n   */\n  public get emission() { return this._emission; }\n  public set emission(val: number) {\n    this._emission = val;\n    this._renderer.updateUniforms();\n    this._renderer.render();\n  }\n  /**\n   * Current value of the `dissipation` option\n   * @see {@link SignBoardOptions}\n   */\n  public get dissipation() { return this._dissipation; }\n  public set dissipation(val: number) {\n    this._dissipation = val;\n    this._renderer.updateUniforms();\n    this._renderer.render();\n  }\n  /**\n   * Current value of the `bulbSize` option\n   * @see {@link SignBoardOptions}\n   */\n  public get bulbSize() { return this._bulbSize; }\n  public set bulbSize(val: number) {\n    this._bulbSize = val;\n    this._renderer.updateUniforms();\n    this._renderer.render();\n  }\n  /**\n   * Current value of the `objectFit` option\n   * @see {@link SignBoardOptions}\n   */\n  public get objectFit() { return this._objectFit; }\n  public set objectFit(val: SignBoardOptions[\"objectFit\"]) {\n    this._objectFit = val;\n    this._renderer.updateTextureOffset();\n    this._renderer.render();\n  }\n  /**\n   * Current value of the `textOptions` option\n   * @see {@link SignBoardOptions}\n   */\n  public get textOptions() { return this._textOptions; }\n  public set textOptions(val: SignBoardOptions[\"textOptions\"]) {\n    this._textOptions = val;\n    this.update();\n  }\n  /**\n   * Current value of the `textPadding` option\n   * @see {@link SignBoardOptions}\n   */\n  public get textPadding() { return this._textPadding; }\n  public set textPadding(val: SignBoardOptions[\"textPadding\"]) {\n    this._textPadding = val;\n    this.update();\n  }\n  /**\n   * Current value of the `scrollSpeed` option\n   * @see {@link SignBoardOptions}\n   */\n  public get scrollSpeed() { return this._scrollSpeed; }\n  public set scrollSpeed(val: SignBoardOptions[\"scrollSpeed\"]) { this._scrollSpeed = val; }\n  /**\n   * Current value of the `initOnFontLoad` option\n   * @see {@link SignBoardOptions}\n   * @readonly\n   */\n  public get initOnFontLoad() { return this._initOnFontLoad; }\n\n  /**\n   * @param {string|HTMLElement} canvas CSS query selector or canvas element\n   * @param {string} src Source URL to the image / video\n   * @param {SignBoardOptions} options An options object\n   */\n  public constructor(canvas: string | HTMLElement, src: string, {\n    contentType = CONTENT_TYPE.IMAGE,\n    contentAttribs = {},\n    autoResize = true,\n    autoInit = true,\n    frameRate = 60,\n    tileSize = 8,\n    emission = 1.5,\n    dissipation = 0.5,\n    bulbSize = 0.7,\n    objectFit = OBJECT_FIT.FILL,\n    textOptions = {},\n    textPadding = 0,\n    scrollSpeed = 0,\n    initOnFontLoad = false\n  }: Partial<SignBoardOptions> = {}) {\n    // Core components\n    this._renderer = new Renderer(getCanvas(canvas), this);\n    this._src = src;\n    this._texture = null;\n\n    // Internal States\n    this._initialized = false;\n\n    // Bind options\n    this._contentType = contentType;\n    this._contentAttribs = contentAttribs;\n    this._autoResize = autoResize;\n    this._autoInit = autoInit;\n    this._frameRate = frameRate;\n    this._tileSize = tileSize;\n    this._emission = emission;\n    this._dissipation = dissipation;\n    this._bulbSize = bulbSize;\n    this._objectFit = objectFit;\n    this._textOptions = textOptions;\n    this._textPadding = textPadding;\n    this._scrollSpeed = scrollSpeed;\n    this._initOnFontLoad = initOnFontLoad;\n\n    this.resize = this.resize.bind(this);\n\n    const shouldCheckFontLoad = Array.isArray(initOnFontLoad)\n      ? initOnFontLoad[0]\n      : initOnFontLoad;\n\n    if (autoInit && !shouldCheckFontLoad) {\n      this.init();\n    }\n\n    if (shouldCheckFontLoad) {\n      this._checkFontLoad();\n    }\n  }\n\n  /**\n   * Destroy the current instance, and release all resources\n   * @returns {void}\n   */\n  public destroy() {\n    this._renderer.destroy();\n    this._updateAutoResize(false);\n    this._initialized = false;\n  }\n\n  /**\n   * Initialize SignBoard\n   * @returns {Promise<SignBoard>} The current instance\n   */\n  public async init(): Promise<this> {\n    const renderer = this._renderer;\n    const textureLoader = new TextureLoader(this);\n\n    const texture = await textureLoader.load();\n    this._texture = texture;\n\n    renderer.resize();\n    renderer.init();\n    renderer.setTexture(texture);\n\n    if (this._autoResize) {\n      this._autoResize = false;\n      this._updateAutoResize(true);\n    }\n\n    this._initialized = true;\n    this.start();\n\n    return this;\n  }\n\n  /**\n   * Resize SignBoard with the latest size of the canvas\n   * @returns {SignBoard} The current instance\n   */\n  public resize(): this {\n    const renderer = this._renderer;\n\n    renderer.resize();\n    renderer.render();\n\n    return this;\n  }\n\n  /**\n   * Start rendering\n   * @returns {SignBoard} The current instance\n   */\n  public start(): this {\n    const renderer = this._renderer;\n\n    if (this._contentType === CONTENT_TYPE.VIDEO || this._scrollSpeed !== 0) {\n      renderer.start();\n    } else {\n      // Render single frame\n      renderer.render();\n    }\n\n    return this;\n  }\n\n  /**\n   * Stop rendering\n   * @returns {SignBoard} The current instance\n   */\n  public stop(): this {\n    this._renderer.stop();\n    return this;\n  }\n\n  /**\n   * Update the texture\n   * @param {string?} src New src to the image/video or text string if `contentType` is \"text\"\n   * @returns {SignBoard} The current instance\n   */\n  public update(src?: string): this {\n    const texture = this._texture;\n\n    if (!texture) throw new SignBoardError(ERROR.MESSAGE.TEXTURE_NOT_INITIALIZED, ERROR.CODE.TEXTURE_NOT_INITIALIZED);\n\n    texture.update(src);\n    this._renderer.updateUniforms();\n\n    return this;\n  }\n\n  private _updateAutoResize(newVal: boolean) {\n    const prevVal = this._autoResize;\n\n    if (prevVal === newVal) return;\n\n    if (newVal) {\n      window.addEventListener(BROWSER.RESIZE, this.resize);\n    } else {\n      window.removeEventListener(BROWSER.RESIZE, this.resize);\n    }\n\n    this._autoResize = newVal;\n  }\n\n  private _checkFontLoad() {\n    const font = this._textOptions.font;\n    if (!font || document.fonts.check(font)) {\n      this.init();\n      return;\n    }\n\n    const initOnFontLoad = this._initOnFontLoad;\n    const textToCheck = Array.isArray(initOnFontLoad)\n      ? initOnFontLoad[1]\n      : \"a\";\n\n    document.fonts.load(font, textToCheck).then(() => {\n      this.init();\n    });\n  }\n}\n\nexport default SignBoard;\n","import SignBoard from './SignBoard';\n\nimport * as Core from \"./core\";\nimport * as Texture from \"./texture\";\nimport * as Constants from \"./const/external\";\nimport { merge } from \"./utils\";\n\nmerge(SignBoard, Core);\nmerge(SignBoard, Texture);\nmerge(SignBoard, Constants);\n\nexport default SignBoard;\n"],"names":["__extends","message","code","_super","Object","setPrototypeOf","_this","SignBoardError","prototype","name","Error","POSITION","Float32Array","TEX_COORD","CODE","WRONG_TYPE","WRONG_OPTION","ELEMENT_NOT_FOUND","ELEMENT_NOT_CANVAS","WEBGL_NOT_SUPPORTED","FAILED_COMPILE_SHADER","FAILED_COMPILE_PROGRAM","FAILED_TO_LOAD_IMAGE","TEXTURE_NOT_INITIALIZED","MESSAGE","val","types","map","type","join","optionName","possible","query","el","tagName","msg","src","BROWSER","WEBGL_CONTEXT_CREATION_ERROR","LOAD","ERROR","RESIZE","READY_STATE_CHANGE","CAN_PLAY_THROUGH","LOADED_DATA","CONTENT_TYPE","IMAGE","VIDEO","TEXT","OBJECT_FIT","FILL","CONTAIN","COVER","NONE","SCALE_DOWN","getElement","targetEl","queryResult","document","querySelector","nodeType","Node","ELEMENT_NODE","getCanvas","test","getWebGLContext","canvas","context","reason","contextAttributes","onWebGLContextCreationError","e","statusMessage","addEventListener","EVENT","getContext","removeEventListener","preventDefault","merge","target","_i","sources","forEach","source","keys","key","getSubImage","contentSize","renderingSize","objectFit","contentType","x","y","xScale","width","yScale","height","newWidth","newHeight","xOffset","parsePadding","padding","Array","isArray","length","signboard","time","_signboard","lastTime","_lastRenderTime","delta","updateInterval","frameRate","_increaseScrollOffset","render","_animationID","requestAnimationFrame","_onAnimationFrame","_canvas","_gl","_program","_texture","_prevScroll","_buffers","position","texcoord","_uniforms","uInvTileSize","uResolution","uEmission","uDissipation","uBulbSize","uTexOffset","uTexScale","uScrollOffset","_contextLost","stop","gl","texture","webGLTexture","deleteProgram","deleteBuffer","deleteTexture","getExtension","loseContext","program","_createWebGLProgram","useProgram","_bindAttributes","_bindUniforms","updateUniforms","init","updateTextureOffset","clientWidth","clientHeight","cancelAnimationFrame","initialized","upload","viewport","drawingBufferWidth","drawingBufferHeight","clear","COLOR_BUFFER_BIT","drawArrays","TRIANGLES","bindTexture","TEXTURE_2D","uniforms","uniform1f","tileSize","uniform2f","emission","dissipation","bulbSize","subImage","size","shader","createShader","getError","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","createProgram","vs","_compileShader","signboardVS","VERTEX_SHADER","fs","signboardFS","FRAGMENT_SHADER","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","positionLocation","getAttribLocation","texcoordLocation","positionBuffer","createBuffer","texcoordBuffer","enableVertexAttribArray","bindBuffer","ARRAY_BUFFER","bufferData","VERTEX","STATIC_DRAW","vertexAttribPointer","FLOAT","getUniformLocation","scrollSpeed","prevVal","newVal","image","_image","naturalWidth","naturalHeight","createTexture","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","texImage2D","RGBA","UNSIGNED_BYTE","video","_video","videoWidth","videoHeight","play","createElement","_context","text","_drawText","clearRect","options","_getDrawingOptions","textPadding","textSize","measureText","actualBoundingBoxRight","actualBoundingBoxLeft","actualBoundingBoxDescent","actualBoundingBoxAscent","fillText","__assign","font","textAlign","fillStyle","textBaseline","textOptions","Promise","_loadImage","_loadVideo","TextTexture","Image","resolve","reject","ImageTexture","attribs","crossOrigin","contentAttribs","setAttribute","VideoTexture","loop","playsInline","autoplay","muted","_a","_b","_c","_d","_e","autoResize","_f","autoInit","_g","_h","_j","_k","_l","_m","_o","_p","_q","_r","initOnFontLoad","_renderer","Renderer","_src","_initialized","_contentType","_contentAttribs","_autoResize","_autoInit","_frameRate","_tileSize","_emission","_dissipation","_bulbSize","_objectFit","_textOptions","_textPadding","_scrollSpeed","_initOnFontLoad","resize","bind","shouldCheckFontLoad","_checkFontLoad","_updateAutoResize","update","destroy","renderer","textureLoader","TextureLoader","load","setTexture","start","window","fonts","check","textToCheck","then","SignBoard","Core","Texture","Constants"],"mappings":"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"}