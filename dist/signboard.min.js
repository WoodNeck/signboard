/*
Copyright (c) 2019 WoodNeck
name: signboard
license: MIT
author: WoodNeck
repository: git+https://github.com/WoodNeck/signboard.git
version: 1.0.1
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).SignBoard=t()}(this,function(){"use strict";var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};var u=function(){return(u=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function i(e,s,a,u){return new(a=a||Promise)(function(i,t){function n(e){try{o(u.next(e))}catch(e){t(e)}}function r(e){try{o(u.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?i(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(n,r)}o((u=u.apply(e,s||[])).next())})}function n(i,n){var r,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&t[0]?o.return:t[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,t[1])).done)return s;switch(o=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,o=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){a.label=t[1];break}if(6===t[0]&&a.label<s[1]){a.label=s[1],s=t;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(t);break}s[2]&&a.ops.pop(),a.trys.pop();continue}t=n.call(i,a)}catch(e){t=[6,e],o=0}finally{r=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}var f=function(i){function n(e,t){e=i.call(this,"(signboard.js) "+e)||this;return Object.setPrototypeOf(e,n.prototype),e.name="SignBoardError",e.code=t,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}(n,i),n}(Error),o=new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),s=new Float32Array([0,1,1,1,0,0,0,0,1,1,1,0]),c={WRONG_TYPE:0,WRONG_OPTION:1,ELEMENT_NOT_FOUND:2,ELEMENT_NOT_CANVAS:3,WEBGL_NOT_SUPPORTED:4,FAILED_COMPILE_SHADER:5,FAILED_COMPILE_PROGRAM:6,FAILED_TO_LOAD_IMAGE:7,TEXTURE_NOT_INITIALIZED:8},a=function(e,t){return e+"("+typeof e+") is not a "+t.map(function(e){return'"'+e+'"'}).join(" or ")+"."},h=function(e,t,i){return"Given value("+e+", "+typeof e+") can't be used for option \""+t+'". Possible values are: '+i.join(", ")},l=function(e){return'Element with selector "'+e+'" not found.'},d=function(e){return"Given element <"+e.tagName+"> is not a canvas."},_=function(e){return'WebGL context creation failed with the following error - "'+e+'"'},g=function(e){return'Failed compiling shader - "'+e+'"'},T=function(e){return'Failed compiling WebGL program - "'+e+'"'},E=function(e){return'Failed to load image with src - "'+e+'"'},b="Texture is not initialized yet",p="webglcontextcreationerror",m="load",x="error",v="resize",O="loadeddata",R={IMAGE:"image",VIDEO:"video",TEXT:"text"},A={FILL:"fill",CONTAIN:"contain",COVER:"cover",NONE:"none",SCALE_DOWN:"scale-down"};function w(e){var t=function(e){var t=null;if("string"==typeof e){var i=document.querySelector(e);if(!i)throw new f(l(e),c.ELEMENT_NOT_FOUND);t=i}else e&&e.nodeType===Node.ELEMENT_NODE&&(t=e);return t}(e);if(!t)throw new f(a(e,["HTMLElement","string"]),c.WRONG_TYPE);if(!/^canvas$/i.test(t.tagName))throw new f(d(t),c.ELEMENT_NOT_CANVAS);return t}function P(e){function t(e){n=e.statusMessage||"Unknown Error"}var i,n="";if(e.addEventListener(p,t),i=e.getContext("webgl",{})||e.getContext("experimental-webgl"),e.removeEventListener(p,t),!i)throw new f(_(n),c.WEBGL_NOT_SUPPORTED);return e.addEventListener("webglcontextlost",function(e){e.preventDefault()},!1),i}function e(i){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.forEach(function(t){Object.keys(t).forEach(function(e){i[e]=t[e]})}),i}var y=function(e,t,i,n){switch(i){case A.FILL:return u({x:0,y:0},t);case A.CONTAIN:var r=t.width/e.width;if((a=t.height/e.height)<=r){var o=e.width*a;return{x:(t.width-o)/2,y:0,width:o,height:t.height}}var s=e.height*r;return{x:0,y:(t.height-s)/2,width:t.width,height:s};case A.COVER:var a,r=t.width/e.width;if((a=t.height/e.height)<=r){s=e.height*r;return{x:0,y:(t.height-s)/2,width:t.width,height:s}}o=e.width*a;return{x:n===R.TEXT?0:(t.width-o)/2,y:0,width:o,height:t.height};case A.NONE:return u({x:(t.width-e.width)/2,y:(t.height-e.height)/2},e);case A.SCALE_DOWN:return e.width>t.width||e.height>t.height?y(e,t,A.CONTAIN,n):y(e,t,A.NONE,n);default:throw new f(h(i,"objectFit",Object.keys(A).map(function(e){return A[e]})),c.WRONG_OPTION)}},S=function(){function e(e,t){var n=this;this._onAnimationFrame=function(e){var t=n._signboard,i=n._lastRenderTime,t=1e3/t.frameRate;(t<=e-i||i<0)&&(n._increaseScrollOffset(),n.render(),n._lastRenderTime=i+t),n._animationID=requestAnimationFrame(n._onAnimationFrame)},this._signboard=t,this._canvas=e,this._gl=P(e),this._program=null,this._texture=null,this._lastRenderTime=-1,this._animationID=-1,this._prevScroll=0,this._buffers={position:null,texcoord:null},this._uniforms={uInvTileSize:null,uResolution:null,uEmission:null,uDissipation:null,uBulbSize:null,uTexOffset:null,uTexScale:null,uScrollOffset:null},this._contextLost=!1}var t=e.prototype;return Object.defineProperty(t,"animating",{get:function(){return 0<=this._animationID},enumerable:!1,configurable:!0}),Object.defineProperty(t,"canvas",{get:function(){return this._canvas},enumerable:!1,configurable:!0}),Object.defineProperty(t,"gl",{get:function(){return this._gl},enumerable:!1,configurable:!0}),t.destroy=function(){this.stop();var e=this._gl,t=null===(t=this._texture)||void 0===t?void 0:t.webGLTexture;e.deleteProgram(this._program),e.deleteBuffer(this._buffers.position),e.deleteBuffer(this._buffers.texcoord),t&&e.deleteTexture(t),null!==(e=e.getExtension("WEBGL_lose_context"))&&void 0!==e&&e.loseContext(),this._texture=null,this._contextLost=!0},t.init=function(){var e,t;this._contextLost||(e=this._gl,t=this._createWebGLProgram(),this._program=t,e.useProgram(t),this._bindAttributes(t),this._bindUniforms(t),this.updateUniforms())},t.setTexture=function(e){e.init(this._gl),this._texture=e,this.updateTextureOffset()},t.resize=function(){var e=this._canvas;e.width=e.clientWidth,e.height=e.clientHeight,this.updateUniforms()},t.start=function(){this._animationID=requestAnimationFrame(this._onAnimationFrame)},t.stop=function(){cancelAnimationFrame(this._animationID),this._animationID=-1,this._lastRenderTime=-1},t.render=function(){var e=this._gl,t=this._texture;if(this._signboard.initialized){if(!t)throw new f(b,c.TEXTURE_NOT_INITIALIZED);t.upload(this._gl),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight),e.clear(e.COLOR_BUFFER_BIT),e.drawArrays(e.TRIANGLES,0,6),e.bindTexture(e.TEXTURE_2D,null)}},t.updateUniforms=function(){var e=this._signboard,t=this._gl,i=this._canvas,n=this._uniforms;this._program&&(t.uniform1f(n.uInvTileSize,1/e.tileSize),t.uniform2f(n.uResolution,i.width,i.height),t.uniform1f(n.uEmission,e.emission),t.uniform1f(n.uDissipation,1/e.dissipation),t.uniform1f(n.uBulbSize,e.bulbSize),this._texture&&this.updateTextureOffset())},t.updateTextureOffset=function(){var e=this._signboard,t=this._gl,i=this._texture,n=this._uniforms;if(!i)throw new f(b,c.TEXTURE_NOT_INITIALIZED);var r={width:t.drawingBufferWidth,height:t.drawingBufferHeight},e=y(i.size,r,e.objectFit,e.contentType);t.uniform2f(n.uTexOffset,e.x/r.width,e.y/r.height),t.uniform2f(n.uTexScale,r.width/e.width,r.height/e.height)},t._compileShader=function(e,t){var i=this._gl,t=i.createShader(t);if(!t)throw new f(g("Unexpected Error: "+i.getError()),c.FAILED_COMPILE_SHADER);if(i.shaderSource(t,e),i.compileShader(t),!i.getShaderParameter(t,i.COMPILE_STATUS))throw new f(g(i.getShaderInfoLog(t)),c.FAILED_COMPILE_SHADER);return t},t._createWebGLProgram=function(){var e=this._gl,t=e.createProgram(),i=this._compileShader("#define GLSLIFY 1\nattribute vec4 aPosition;attribute vec2 aTexCoord;varying vec2 vTexCoord;void main(){gl_Position=aPosition;vTexCoord=aTexCoord;}",e.VERTEX_SHADER),n=this._compileShader("precision highp float;\n#define GLSLIFY 1\nvarying vec2 vTexCoord;uniform float uInvTileSize;uniform vec2 uResolution;uniform float uEmission;uniform float uDissipation;uniform float uBulbSize;uniform vec2 uTexOffset;uniform vec2 uTexScale;uniform float uScrollOffset;uniform sampler2D uTexture;float sstep(float edge0,float edge1,float x){x=clamp((x-edge0)/(edge1-edge0),0.0,1.0);return x*x*(3.0-2.0*x);}float circulate(float x,vec2 range){float diff=range[1]-range[0];float maxOffset=mod((x-range[1]),diff);float minOffset=mod((range[0]-x),diff);float ltMin=step(x,range[0]);float gtMax=step(range[1],x);return ltMin*(range[1]-minOffset)+gtMax*(range[0]+maxOffset)+(1.0-ltMin)*(1.0-gtMax)*x;}void main(){vec2 tilesPerSide=floor(uResolution*uInvTileSize);vec2 invTilesPerSide=1.0/tilesPerSide;vec2 tileCenter=floor(vTexCoord*tilesPerSide)*invTilesPerSide+invTilesPerSide*0.5;vec2 diffToCenter=vTexCoord-tileCenter;vec2 distToCenter=diffToCenter*diffToCenter*4.0*tilesPerSide*tilesPerSide;float dist=distToCenter.x+distToCenter.y;float dissipation=1.0-sstep(0.0,pow(uBulbSize,uDissipation),pow(dist,uDissipation));vec2 scrollOffset=vec2(floor(uScrollOffset*tilesPerSide[0])*invTilesPerSide[0],0.0);float invTexScaleHalf=max(uTexScale.x*0.5,0.5);vec2 origTexRange=vec2(0.5-invTexScaleHalf,0.5+invTexScaleHalf);vec2 texUV=(tileCenter-uTexOffset+scrollOffset)*uTexScale;texUV.x=circulate(texUV.x,origTexRange);vec2 inBorderUV=step(vec2(0.0),texUV)*step(texUV,vec2(1.0));float inBorder=step(2.0,inBorderUV.x+inBorderUV.y);gl_FragColor=texture2D(uTexture,texUV)*dissipation*uEmission*inBorder;}",e.FRAGMENT_SHADER);if(e.attachShader(t,i),e.attachShader(t,n),e.linkProgram(t),!e.getProgramParameter(t,e.LINK_STATUS))throw new f(T(e.getProgramInfoLog(t)),c.FAILED_COMPILE_PROGRAM);return t},t._bindAttributes=function(e){var t=this._gl,i=t.getAttribLocation(e,"aPosition"),n=t.getAttribLocation(e,"aTexCoord"),r=t.createBuffer(),e=t.createBuffer();this._buffers.position=r,this._buffers.texcoord=e,t.enableVertexAttribArray(i),t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,o,t.STATIC_DRAW),t.vertexAttribPointer(i,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(n),t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,s,t.STATIC_DRAW),t.vertexAttribPointer(n,2,t.FLOAT,!1,0,0)},t._bindUniforms=function(e){var t,i=this._gl,n=this._uniforms;for(t in n)n[t]=i.getUniformLocation(e,t)},t._increaseScrollOffset=function(){var e=this._signboard,t=this._gl,i=this._texture,n=this._uniforms,r=e.scrollSpeed;if(0!==r){if(!i)throw new f(b,c.TEXTURE_NOT_INITIALIZED);e=this._prevScroll+r*(1e3/e.frameRate)/t.drawingBufferWidth;this._prevScroll=e,t.uniform1f(n.uScrollOffset,e)}},e}(),t={__proto__:null,ERROR_CODE:c,CONTENT_TYPE:R,OBJECT_FIT:A},I=function(){function e(e){this._image=e,this._texture=null}var t=e.prototype;return Object.defineProperty(t,"webGLTexture",{get:function(){return this._texture},enumerable:!1,configurable:!0}),Object.defineProperty(t,"size",{get:function(){return{width:this._image.naturalWidth,height:this._image.naturalHeight}},enumerable:!1,configurable:!0}),t.init=function(e){this._texture=e.createTexture()},t.upload=function(e){e.bindTexture(e.TEXTURE_2D,this._texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._image)},t.update=function(e){e&&(this._image.src=e)},e}(),L=function(){function e(e){this._video=e,this._texture=null}var t=e.prototype;return Object.defineProperty(t,"webGLTexture",{get:function(){return this._texture},enumerable:!1,configurable:!0}),Object.defineProperty(t,"size",{get:function(){return{width:this._video.videoWidth,height:this._video.videoHeight}},enumerable:!1,configurable:!0}),t.init=function(e){this._texture=e.createTexture(),this._video.play()},t.upload=function(e){e.bindTexture(e.TEXTURE_2D,this._texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._video)},t.update=function(e){var t;e&&((t=this._video).src=e,t.play())},e}(),D=function(){function e(e){this._signboard=e,this._canvas=document.createElement("canvas"),this._context=this._canvas.getContext("2d"),this._texture=null}var t=e.prototype;return Object.defineProperty(t,"webGLTexture",{get:function(){return this._texture},enumerable:!1,configurable:!0}),Object.defineProperty(t,"size",{get:function(){return{width:this._canvas.width,height:this._canvas.height}},enumerable:!1,configurable:!0}),t.init=function(e){var t=this._signboard.src;this._texture=e.createTexture(),this._drawText(t)},t.update=function(e){var t=this._canvas;this._context.clearRect(0,0,t.width,t.height),this._drawText(null!=e?e:this._signboard.src)},t.upload=function(e){e.bindTexture(e.TEXTURE_2D,this._texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this._canvas)},t._drawText=function(e){var t=this._canvas,i=this._context,n=this._signboard,r=this._getDrawingOptions();for(o in r)i[o]=r[o];var o,s=function(e){if(Array.isArray(e)){if(2===e.length)return[e[0],e[1],e[0],e[1]];if(4===e.length)return e;throw new f(h(e,"textPadding",["number","[number, number]","[number, number, number, number]"]),c.WRONG_OPTION)}return[e,e,e,e]}(n.textPadding),n=i.measureText(e);for(o in t.width=n.actualBoundingBoxRight-n.actualBoundingBoxLeft+s[1]+s[3],t.height=n.actualBoundingBoxDescent-n.actualBoundingBoxAscent+s[0]+s[2],r)i[o]=r[o];i.fillText(e,s[3],s[0])},t._getDrawingOptions=function(){var e=this._signboard;return u({font:"32pt serif",textAlign:"left",fillStyle:"red",textBaseline:"top"},e.textOptions)},e}(),N=function(){function e(e){this._signboard=e}var t=e.prototype;return t.load=function(){return i(this,void 0,Promise,function(){var t;return n(this,function(e){switch(t=this._signboard.contentType){case R.IMAGE:return[2,this._loadImage()];case R.VIDEO:return[2,this._loadVideo()];case R.TEXT:return[2,new D(this._signboard)];default:throw new f(h(t,"contentType",Object.keys(R).map(function(e){return R[e]})),c.WRONG_OPTION)}})})},t._loadImage=function(){return i(this,void 0,Promise,function(){var r,o,s;return n(this,function(e){return r=this._signboard,o=new Image,s=r.src,[2,new Promise(function(e,t){o.addEventListener(m,function(){e(new I(o))}),o.addEventListener(x,function(){t(new f(E(s),c.FAILED_TO_LOAD_IMAGE))});var i,n=u({crossOrigin:"anonymous"},r.contentAttribs);for(i in n)o.setAttribute(i,n[i]);o.src=s})]})})},t._loadVideo=function(){return i(this,void 0,Promise,function(){var r,o,s;return n(this,function(e){return r=this._signboard,o=document.createElement("video"),s=r.src,[2,new Promise(function(e,t){o.addEventListener(O,function(){e(new L(o))}),o.addEventListener(x,function(){t(new f(E(s),c.FAILED_TO_LOAD_IMAGE))});var i,n=u({loop:!0,playsInline:!0,autoplay:!0,muted:!0,crossOrigin:"anonymous"},r.contentAttribs);for(i in n)o.setAttribute(i,n[i]);o.src=s})]})})},e}(),U=function(){function e(e,t,i){var n=void 0===i?{}:i,r=n.contentType,o=void 0===r?R.IMAGE:r,s=n.contentAttribs,a=void 0===s?{}:s,u=n.autoResize,f=void 0===u||u,c=n.autoInit,h=void 0===c||c,l=n.frameRate,d=void 0===l?60:l,_=n.tileSize,g=void 0===_?8:_,i=n.emission,r=void 0===i?1.5:i,s=n.dissipation,u=void 0===s?.5:s,c=n.bulbSize,l=void 0===c?.7:c,_=n.objectFit,i=void 0===_?A.FILL:_,s=n.textOptions,c=void 0===s?{}:s,_=n.textPadding,s=void 0===_?0:_,_=n.scrollSpeed,_=void 0===_?0:_,n=n.initOnFontLoad,n=void 0!==n&&n;this._renderer=new S(w(e),this),this._src=t,this._texture=null,this._initialized=!1,this._contentType=o,this._contentAttribs=a,this._autoResize=f,this._autoInit=h,this._frameRate=d,this._tileSize=g,this._emission=r,this._dissipation=u,this._bulbSize=l,this._objectFit=i,this._textOptions=c,this._textPadding=s,this._scrollSpeed=_,this._initOnFontLoad=n,this.resize=this.resize.bind(this);n=Array.isArray(n)?n[0]:n;h&&!n&&this.init(),n&&this._checkFontLoad()}var t=e.prototype;return Object.defineProperty(t,"renderer",{get:function(){return this._renderer},enumerable:!1,configurable:!0}),Object.defineProperty(t,"src",{get:function(){return this._src},enumerable:!1,configurable:!0}),Object.defineProperty(t,"initialized",{get:function(){return this._initialized},enumerable:!1,configurable:!0}),Object.defineProperty(t,"texture",{get:function(){return this._texture},enumerable:!1,configurable:!0}),Object.defineProperty(t,"contentType",{get:function(){return this._contentType},set:function(e){this._contentType=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"contentAttribs",{get:function(){return this._contentAttribs},set:function(e){this._contentAttribs=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"autoResize",{get:function(){return this._autoResize},set:function(e){this._updateAutoResize(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"autoInit",{get:function(){return this._autoInit},enumerable:!1,configurable:!0}),Object.defineProperty(t,"frameRate",{get:function(){return this._frameRate},set:function(e){this._frameRate=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"tileSize",{get:function(){return this._tileSize},set:function(e){this._tileSize=e,this._renderer.updateUniforms(),this._renderer.render()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"emission",{get:function(){return this._emission},set:function(e){this._emission=e,this._renderer.updateUniforms(),this._renderer.render()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"dissipation",{get:function(){return this._dissipation},set:function(e){this._dissipation=e,this._renderer.updateUniforms(),this._renderer.render()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"bulbSize",{get:function(){return this._bulbSize},set:function(e){this._bulbSize=e,this._renderer.updateUniforms(),this._renderer.render()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"objectFit",{get:function(){return this._objectFit},set:function(e){this._objectFit=e,this._renderer.updateTextureOffset(),this._renderer.render()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"textOptions",{get:function(){return this._textOptions},set:function(e){this._textOptions=e,this.update()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"textPadding",{get:function(){return this._textPadding},set:function(e){this._textPadding=e,this.update()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"scrollSpeed",{get:function(){return this._scrollSpeed},set:function(e){this._scrollSpeed=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"initOnFontLoad",{get:function(){return this._initOnFontLoad},enumerable:!1,configurable:!0}),t.destroy=function(){this._renderer.destroy(),this._updateAutoResize(!1),this._initialized=!1},t.init=function(){return i(this,void 0,Promise,function(){var t,i;return n(this,function(e){switch(e.label){case 0:return t=this._renderer,[4,new N(this).load()];case 1:return i=e.sent(),this._texture=i,t.resize(),t.init(),t.setTexture(i),this._autoResize&&(this._autoResize=!1,this._updateAutoResize(!0)),this._initialized=!0,this.start(),[2,this]}})})},t.resize=function(){var e=this._renderer;return e.resize(),e.render(),this},t.start=function(){var e=this._renderer;return this._contentType===R.VIDEO||0!==this._scrollSpeed?e.start():e.render(),this},t.stop=function(){return this._renderer.stop(),this},t.update=function(e){var t=this._texture;if(!t)throw new f(b,c.TEXTURE_NOT_INITIALIZED);return t.update(e),this._renderer.updateUniforms(),this},t._updateAutoResize=function(e){this._autoResize!==e&&(e?window.addEventListener(v,this.resize):window.removeEventListener(v,this.resize),this._autoResize=e)},t._checkFontLoad=function(){var e,t=this,i=this._textOptions.font;i&&!document.fonts.check(i)?(e=this._initOnFontLoad,e=Array.isArray(e)?e[1]:"a",document.fonts.load(i,e).then(function(){t.init()})):this.init()},e}(),F={__proto__:null,ImageTexture:I,VideoTexture:L};return e(U,{__proto__:null,Renderer:S,SignBoardError:f,TextureLoader:N}),e(U,F),e(U,t),U});
//# sourceMappingURL=signboard.min.js.map
