{"version":3,"file":"signboard.js","sources":["../src/core/SignBoardError.ts","../src/const/attribute.ts","../src/const/error.ts","../src/const/event.ts","../src/utils.ts","../src/core/Renderer.ts","../src/const/external.ts","../src/texture/ImageTexture.ts","../src/texture/VideoTexture.ts","../src/core/TextureLoader.ts","../src/SignBoard.ts","../src/index.umd.ts"],"sourcesContent":["class SignBoardError extends Error {\n  constructor(\n    public message: string,\n    public code: number) {\n    super(`(signboard.js) ${message}`);\n    Object.setPrototypeOf(this, SignBoardError.prototype);\n    this.name = \"SignBoardError\";\n  }\n}\n\nexport default SignBoardError;\n","export const POSITION = new Float32Array([\n  -1, -1,\n  1, -1,\n  -1, 1,\n  -1, 1,\n  1, -1,\n  1, 1\n]);\n\nexport const TEX_COORD = new Float32Array([\n  0, 1,\n  1, 1,\n  0, 0,\n  0, 0,\n  1, 1,\n  1, 0\n]);\n","/**\n * Error codes of {@link SignBoardError}\n * @name ERROR_CODES\n * @memberof Constants\n * @type object\n * @property {number} WRONG_TYPE 0\n * @property {number} ELEMENT_NOT_FOUND 1\n * @property {number} CANVAS_NOT_FOUND 2\n * @property {number} WEBGL_NOT_SUPPORTED 3\n * @property {number} FAILED_COMPILE_SHADER 4\n * @property {number} FAILED_COMPILE_PROGRAM 5\n * @property {number} FAILED_TO_LOAD_IMAGE 6\n */\nexport const CODE: {\n  [key in keyof typeof MESSAGE]: number;\n} = {\n  WRONG_TYPE: 0,\n  ELEMENT_NOT_FOUND: 1,\n  ELEMENT_NOT_CANVAS: 2,\n  WEBGL_NOT_SUPPORTED: 3,\n  FAILED_COMPILE_SHADER: 4,\n  FAILED_COMPILE_PROGRAM: 5,\n  FAILED_TO_LOAD_IMAGE: 6\n};\n\nexport const MESSAGE = {\n  WRONG_TYPE: (val: any, types: string[]) => `${typeof val} is not a ${types.map(type => `\"${type}\"`).join(\" or \")}.`,\n  ELEMENT_NOT_FOUND: (query: string) => `Element with selector \"${query}\" not found.`,\n  ELEMENT_NOT_CANVAS: (el: HTMLElement) => `Given element <${el.tagName}> is not a canvas.`,\n  WEBGL_NOT_SUPPORTED: (msg: string) => `WebGL context creation failed with the following error - \"${msg}\"`,\n  FAILED_COMPILE_SHADER: (msg: string | null) => `Failed compiling shader - \"${msg}\"`,\n  FAILED_COMPILE_PROGRAM: (msg: string | null) => `Failed compiling WebGL program - \"${msg}\"`,\n  FAILED_TO_LOAD_IMAGE: (src: string) => `Failed to load image with src - \"${src}\"`\n};\n","export const BROWSER = {\n  WEBGL_CONTEXT_CREATION_ERROR: \"webglcontextcreationerror\",\n  LOAD: \"load\",\n  ERROR: \"error\",\n  RESIZE: \"resize\",\n  READY_STATE_CHANGE: \"readystatechange\",\n  CAN_PLAY_THROUGH: \"canplaythrough\",\n  LOADED_DATA: \"loadeddata\"\n};\n","import SignBoardError from \"./core/SignBoardError\";\nimport * as EVENT from \"./const/event\";\nimport * as ERROR from \"./const/error\";\nimport { Merged } from \"./types\";\n\nexport function getElement(el: HTMLElement | string | null): HTMLElement | null {\n  let targetEl: HTMLElement | null = null;\n\n  if (typeof el === \"string\") {\n    const queryResult = document.querySelector(el);\n    if (!queryResult) {\n      throw new SignBoardError(ERROR.MESSAGE.ELEMENT_NOT_FOUND(el), ERROR.CODE.ELEMENT_NOT_FOUND);\n    }\n    targetEl = queryResult as HTMLElement;\n  } else if (el && el.nodeType === Node.ELEMENT_NODE) {\n    targetEl = el;\n  }\n\n  return targetEl;\n}\n\nexport const getCanvas = (el: HTMLElement | string): HTMLCanvasElement => {\n  const targetEl = getElement(el);\n\n  if (!targetEl) {\n    throw new SignBoardError(ERROR.MESSAGE.WRONG_TYPE(el, [\"HTMLElement\", \"string\"]), ERROR.CODE.WRONG_TYPE);\n  }\n\n  if (!/^canvas$/i.test(targetEl.tagName)) {\n    throw new SignBoardError(ERROR.MESSAGE.ELEMENT_NOT_CANVAS(targetEl), ERROR.CODE.ELEMENT_NOT_CANVAS);\n  }\n\n  return targetEl as HTMLCanvasElement;\n}\n\nexport const getWebGLContext = (canvas: HTMLCanvasElement): WebGLRenderingContext => {\n  let context: WebGLRenderingContext | null = null;\n  let reason: string = \"\";\n  const contextAttributes: WebGLContextAttributes = {};\n\n  const onWebGLContextCreationError = (e: Event) => {\n    reason = (e as WebGLContextEvent).statusMessage || \"Unknown Error\";\n  }\n\n  canvas.addEventListener(EVENT.BROWSER.WEBGL_CONTEXT_CREATION_ERROR, onWebGLContextCreationError);\n  context = canvas.getContext(\"webgl\", contextAttributes) as WebGLRenderingContext;\n  canvas.removeEventListener(EVENT.BROWSER.WEBGL_CONTEXT_CREATION_ERROR, onWebGLContextCreationError);\n\n  if (!context) throw new SignBoardError(ERROR.MESSAGE.WEBGL_NOT_SUPPORTED(reason), ERROR.CODE.WEBGL_NOT_SUPPORTED);\n\n  canvas.addEventListener(\"webglcontextlost\", e => {\n    console.log(\"contextlost\");\n    e.preventDefault();\n  }, false);\n\n  return context;\n}\n\nexport const merge = <From extends {[key: string]: any}, To extends {[key: string]: any}>(target: From, ...sources: To[]): Merged<From, To> => {\n  sources.forEach(source => {\n    Object.keys(source).forEach(key => {\n      (target as any)[key] = source[key];\n    });\n  });\n\n  return target as Merged<From, To>;\n};\n","import SignBoardError from \"./SignBoardError\";\nimport Texture from \"../texture/Texture\";\nimport signboardVS from \"../shader/signboard.vert\";\nimport signboardFS from \"../shader/signboard.frag\";\nimport * as ATTRIBUTE from \"../const/attribute\";\nimport * as ERROR from \"../const/error\";\nimport { getWebGLContext } from \"../utils\";\n\nexport interface RendererOptions {\n  frameRate: number;\n  tileSize: number;\n  emission: number;\n  bulbSize: number;\n}\n\nclass Renderer {\n  private _canvas: HTMLCanvasElement;\n  private _gl: WebGLRenderingContext;\n  private _program: WebGLProgram | null;\n  private _uniforms: {\n    uInvTileSize: WebGLUniformLocation | null,\n    uResolution: WebGLUniformLocation | null,\n    uEmission: WebGLUniformLocation | null,\n    uBulbSize: WebGLUniformLocation | null\n  }\n  private _texture: Texture | null;\n  private _lastRenderTime: number;\n  private _animationID: number;\n\n  // Options\n  private _frameRate: number;\n  private _tileSize: number;\n  private _emission: number;\n  private _bulbSize: number;\n\n  public get canvas() { return this._canvas; }\n  public get gl() { return this._gl; }\n\n  public get frameRate() { return this._frameRate; }\n  public set frameRate(val: number) { this._frameRate = val; }\n  public get tileSize() { return this._tileSize; }\n  public set tileSize(val: number) {\n    this._tileSize = val;\n    this._updateUniforms();\n    this.render();\n  }\n  public get emission() { return this._emission; }\n  public set emission(val: number) {\n    this._emission = val;\n    this._updateUniforms();\n    this.render();\n  }\n  public get bulbSize() { return this._bulbSize; }\n  public set bulbSize(val: number) {\n    this._bulbSize = val;\n    this._updateUniforms();\n    this.render();\n  }\n\n  public constructor(canvas: HTMLCanvasElement, {\n    frameRate,\n    tileSize,\n    emission,\n    bulbSize\n  }: RendererOptions) {\n    this._canvas = canvas;\n    this._gl = getWebGLContext(canvas);\n    this._program = null;\n    this._texture = null;\n    this._lastRenderTime = -1;\n    this._animationID = -1;\n    this._uniforms = {\n      uInvTileSize: null,\n      uResolution: null,\n      uEmission: null,\n      uBulbSize: null\n    };\n\n    // Options\n    this._frameRate = frameRate;\n    this._tileSize = tileSize;\n    this._emission = emission;\n    this._bulbSize = bulbSize;\n  }\n\n  public destroy() {\n    this.stop();\n\n    this._texture = null;\n    this._gl.deleteProgram(this._program);\n  }\n\n  public init() {\n    const gl = this._gl;\n    const program = this._createWebGLProgram();\n\n    this._program = program;\n\n    gl.useProgram(program);\n    this._bindAttributes(program);\n    this._bindUniforms(program);\n    this._updateUniforms();\n  }\n\n  public setTexture(texture: Texture) {\n    texture.init(this._gl);\n    this._texture = texture;\n  }\n\n  public resize() {\n    const canvas = this._canvas;\n\n    canvas.width = canvas.clientWidth;\n    canvas.height = canvas.clientHeight;\n\n    this._updateUniforms();\n  }\n\n  /**\n   */\n  public start() {\n    this._animationID = requestAnimationFrame(this._onAnimationFrame);\n  }\n\n  /**\n   * Stop animation\n   */\n  public stop() {\n    cancelAnimationFrame(this._animationID);\n    this._animationID = -1;\n    this._lastRenderTime = -1;\n  }\n\n  /**\n   * Render a single frame\n   */\n  public render() {\n    const gl = this._gl;\n\n    this._texture!.upload(this._gl);\n\n    gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    gl.drawArrays(gl.TRIANGLES, 0, 6);\n    gl.bindTexture(gl.TEXTURE_2D, null);\n  }\n\n  private _onAnimationFrame = (time: number) => {\n    const lastTime = this._lastRenderTime;\n    const timeDiff = time - lastTime;\n    const updateInterval = 1000 / this._frameRate;\n\n    if (timeDiff >= updateInterval || lastTime < 0) {\n      this.render();\n      this._lastRenderTime = lastTime + updateInterval;\n    }\n\n    this._animationID = requestAnimationFrame(this._onAnimationFrame);\n  }\n\n  private _compileShader(src: string, type: WebGLRenderingContextBase[\"VERTEX_SHADER\"] | WebGLRenderingContextBase[\"FRAGMENT_SHADER\"]) {\n    const gl = this._gl;\n    const shader = gl.createShader(type)!;\n\n    gl.shaderSource(shader, src);\n    gl.compileShader(shader);\n\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n      throw new SignBoardError(ERROR.MESSAGE.FAILED_COMPILE_SHADER(gl.getShaderInfoLog(shader)), ERROR.CODE.FAILED_COMPILE_SHADER);\n    }\n\n    return shader;\n  }\n\n  private _createWebGLProgram() {\n    const gl = this._gl;\n\n    const program = gl.createProgram()!;\n    const vs = this._compileShader(signboardVS, gl.VERTEX_SHADER);\n    const fs = this._compileShader(signboardFS, gl.FRAGMENT_SHADER);\n\n    gl.attachShader(program, vs);\n    gl.attachShader(program, fs);\n    gl.linkProgram(program);\n\n    if (!gl.getProgramParameter( program, gl.LINK_STATUS)) {\n      throw new SignBoardError(ERROR.MESSAGE.FAILED_COMPILE_PROGRAM(gl.getProgramInfoLog(program)), ERROR.CODE.FAILED_COMPILE_PROGRAM);\n    }\n\n    return program;\n  }\n\n  private _bindAttributes(program: WebGLProgram) {\n    const gl = this._gl;\n    const positionLocation = gl.getAttribLocation(program, \"aPosition\");\n    const texcoordLocation = gl.getAttribLocation(program, \"aTexCoord\");\n\n    const positionBuffer = gl.createBuffer();\n    const texcoordBuffer = gl.createBuffer();\n\n    gl.enableVertexAttribArray(positionLocation);\n    gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, ATTRIBUTE.POSITION, gl.STATIC_DRAW);\n    gl.vertexAttribPointer(positionLocation, 2, gl.FLOAT, false, 0, 0);\n\n    gl.enableVertexAttribArray(texcoordLocation);\n    gl.bindBuffer(gl.ARRAY_BUFFER, texcoordBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, ATTRIBUTE.TEX_COORD, gl.STATIC_DRAW);\n    gl.vertexAttribPointer(texcoordLocation, 2, gl.FLOAT, false, 0, 0);\n  }\n\n  private _bindUniforms(program: WebGLProgram) {\n    const gl = this._gl;\n\n    this._uniforms = {\n      uInvTileSize: gl.getUniformLocation(program, \"uInvTileSize\"),\n      uResolution: gl.getUniformLocation(program, \"uResolution\"),\n      uEmission: gl.getUniformLocation(program, \"uEmission\"),\n      uBulbSize: gl.getUniformLocation(program, \"uBulbSize\")\n    }\n  }\n\n  private _updateUniforms() {\n    const gl = this._gl;\n    const canvas = this._canvas;\n    const uniforms = this._uniforms;\n\n    if (!this._program) return;\n\n    gl.uniform1f(uniforms.uInvTileSize, 1 / this._tileSize);\n    gl.uniform2f(uniforms.uResolution, canvas.width, canvas.height);\n    gl.uniform1f(uniforms.uEmission, this._emission);\n    gl.uniform1f(uniforms.uBulbSize, this._bulbSize);\n  }\n}\n\nexport default Renderer;\n","export { CODE as ERROR_CODE } from \"./error\";\n\nexport const CONTENT_TYPE = {\n  IMAGE: \"image\",\n  VIDEO: \"video\"\n} as const;\n","class ImageTexture {\n  private _image: HTMLImageElement;\n  private _texture: WebGLTexture | null;\n\n  public constructor(image: HTMLImageElement) {\n    this._image = image;\n    this._texture = null;\n  }\n\n  public init(gl: WebGLRenderingContext) {\n    this._texture = gl.createTexture();\n  }\n\n  public upload(gl: WebGLRenderingContext) {\n    gl.bindTexture(gl.TEXTURE_2D, this._texture);\n\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, this._image);\n  }\n}\n\nexport default ImageTexture;\n","class VideoTexture {\n  private _video: HTMLVideoElement;\n  private _texture: WebGLTexture | null;\n\n  public constructor(video: HTMLVideoElement) {\n    this._video = video;\n    this._texture = null;\n  }\n\n  public init(gl: WebGLRenderingContext) {\n    this._texture = gl.createTexture();\n    this._video.play();\n  }\n\n  public upload(gl: WebGLRenderingContext) {\n    gl.bindTexture(gl.TEXTURE_2D, this._texture);\n\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, this._video);\n  }\n}\n\nexport default VideoTexture;\n","import SignBoardError from \"./SignBoardError\";\nimport * as ERROR from \"../const/error\";\nimport { BROWSER } from \"../const/event\";\nimport { CONTENT_TYPE } from \"../const/external\";\nimport { ValueOf } from \"../types\";\nimport Texture from \"../texture/Texture\";\nimport ImageTexture from \"../texture/ImageTexture\";\nimport VideoTexture from \"../texture/VideoTexture\";\n\nclass TextureLoader {\n  private _src: string;\n  private _type: ValueOf<typeof CONTENT_TYPE>;\n\n  public constructor(src: string, type: ValueOf<typeof CONTENT_TYPE>) {\n    this._src = src;\n    this._type = type;\n  }\n\n  public async load(): Promise<Texture> {\n    switch (this._type) {\n      case CONTENT_TYPE.IMAGE:\n        return this._loadImage();\n      case CONTENT_TYPE.VIDEO:\n        return this._loadVideo();\n    }\n  }\n\n  private async _loadImage(): Promise<ImageTexture> {\n    const image = new Image();\n    const src = this._src;\n\n    return new Promise((resolve, reject) => {\n      image.addEventListener(BROWSER.LOAD, () => {\n        resolve(new ImageTexture(image));\n      });\n      image.addEventListener(BROWSER.ERROR, () => {\n        reject(new SignBoardError(ERROR.MESSAGE.FAILED_TO_LOAD_IMAGE(src), ERROR.CODE.FAILED_TO_LOAD_IMAGE));\n      });\n\n      image.crossOrigin = \"anonymous\";\n      image.src = src;\n    });\n  }\n\n  private async _loadVideo(): Promise<VideoTexture> {\n    const video = document.createElement(\"video\");\n    const src = this._src;\n\n    return new Promise((resolve, reject) => {\n      video.addEventListener(BROWSER.LOADED_DATA, () => {\n        resolve(new VideoTexture(video));\n      });\n      video.addEventListener(BROWSER.ERROR, () => {\n        reject(new SignBoardError(ERROR.MESSAGE.FAILED_TO_LOAD_IMAGE(src), ERROR.CODE.FAILED_TO_LOAD_IMAGE));\n      });\n\n      video.loop = true;\n      video.playsInline = true;\n      video.crossOrigin = \"anonymous\";\n      video.src = src;\n      video.load();\n    });\n  }\n}\n\nexport default TextureLoader;\n","import Renderer from \"./core/Renderer\";\nimport TextureLoader from \"./core/TextureLoader\";\nimport { BROWSER } from \"./const/event\";\nimport { getCanvas } from \"./utils\";\nimport { CONTENT_TYPE } from \"./const/external\";\nimport { ValueOf } from \"./types\";\n\n/**\n * @interface\n * @param {\"image\" | \"video\"} [contentType=\"image\"]\n * @param {number} [frameRate=60]\n * @param {boolean} [autoResize=true]\n * @param {number} [tileSize=8]\n * @param {number} [emission=1]\n * @param {number} [bulbSize=0.7]\n */\ninterface SignBoardOptions {\n  contentType: ValueOf<typeof CONTENT_TYPE>;\n  frameRate: number;\n  autoResize: boolean;\n  tileSize: number;\n  emission: number;\n  bulbSize: number;\n}\n\nclass SignBoard {\n  private _renderer: Renderer;\n  private _src: string;\n  private _initialized: boolean;\n\n  // Options\n  private _contentType: ValueOf<typeof CONTENT_TYPE>;\n  private _autoResize: boolean;\n\n  public get renderer() { return this._renderer; }\n  public get src() { return this._src; }\n  public get initialized() { return this._initialized; }\n\n  // Options\n  public get contentType() { return this._contentType; }\n  public set contentType(val: ValueOf<typeof CONTENT_TYPE>) { this._contentType = val; }\n  public get frameRate() { return this._renderer.frameRate; }\n  public set frameRate(val: number) { this._renderer.frameRate = val; }\n  public get tileSize() { return this._renderer.tileSize; }\n  public set tileSize(val: number) { this._renderer.tileSize = val; }\n  public get autoResize() { return this._autoResize; }\n  public set autoResize(val: boolean) { this._updateAutoResize(val); }\n\n  /**\n   *\n   * @param {string|HTMLElement} canvas CSS query selector or canvas element\n   * @param {string} src Source URL to the image / video\n   * @param {SignBoardOptions} options An options object\n   */\n  public constructor(canvas: string | HTMLElement, src: string, {\n    contentType = CONTENT_TYPE.IMAGE,\n    frameRate = 60,\n    autoResize = true,\n    tileSize = 8,\n    emission = 1,\n    bulbSize = 0.7\n  }: Partial<SignBoardOptions> = {}) {\n    // Core components\n    this._renderer = new Renderer(getCanvas(canvas), {\n      frameRate,\n      tileSize,\n      emission,\n      bulbSize\n    });\n    this._src = src;\n\n    // Internal States\n    this._initialized = false;\n\n    // Bind options\n    this._contentType = contentType\n    this._autoResize = autoResize;\n\n    this.resize = this.resize.bind(this);\n\n    this.init();\n  }\n\n  public async init() {\n    const renderer = this._renderer;\n    const textureLoader = new TextureLoader(this._src, this._contentType);\n\n    const texture = await textureLoader.load();\n\n    renderer.resize();\n    renderer.init();\n    renderer.setTexture(texture);\n\n    if (this._contentType === CONTENT_TYPE.VIDEO) {\n      renderer.start();\n    } else {\n      renderer.render();\n    }\n\n    if (this._autoResize) {\n      this._autoResize = false;\n      this._updateAutoResize(true);\n    }\n    this._initialized = true;\n  }\n\n  public resize() {\n    const renderer = this._renderer;\n\n    renderer.resize();\n    renderer.render();\n  }\n\n  private _updateAutoResize(newVal: boolean) {\n    const prevVal = this._autoResize;\n\n    if (prevVal === newVal) return;\n\n    if (newVal) {\n      window.addEventListener(BROWSER.RESIZE, this.resize);\n    } else {\n      window.removeEventListener(BROWSER.RESIZE, this.resize);\n    }\n\n    this._autoResize = newVal;\n  }\n}\n\nexport default SignBoard;\n","import SignBoard from './SignBoard';\n\nimport * as Core from \"./core\";\nimport * as Texture from \"./texture\";\nimport * as Constants from \"./const/external\";\nimport { merge } from \"./utils\";\n\nmerge(SignBoard, Core);\nmerge(SignBoard, Texture);\nmerge(SignBoard, Constants);\n\nexport default SignBoard;\n"],"names":["__extends","message","code","_super","_this","Object","setPrototypeOf","SignBoardError","prototype","name","Error","POSITION","Float32Array","TEX_COORD","CODE","WRONG_TYPE","ELEMENT_NOT_FOUND","ELEMENT_NOT_CANVAS","WEBGL_NOT_SUPPORTED","FAILED_COMPILE_SHADER","FAILED_COMPILE_PROGRAM","FAILED_TO_LOAD_IMAGE","MESSAGE","val","types","map","type","join","query","el","tagName","msg","src","BROWSER","WEBGL_CONTEXT_CREATION_ERROR","LOAD","ERROR","RESIZE","READY_STATE_CHANGE","CAN_PLAY_THROUGH","LOADED_DATA","getElement","targetEl","queryResult","document","querySelector","nodeType","Node","ELEMENT_NODE","getCanvas","test","getWebGLContext","canvas","context","reason","contextAttributes","onWebGLContextCreationError","e","statusMessage","addEventListener","EVENT","getContext","removeEventListener","console","log","preventDefault","merge","target","_i","sources","forEach","source","keys","key","_a","frameRate","tileSize","emission","bulbSize","time","lastTime","_lastRenderTime","timeDiff","updateInterval","_frameRate","render","_animationID","requestAnimationFrame","_onAnimationFrame","_canvas","_gl","_program","_texture","_uniforms","uInvTileSize","uResolution","uEmission","uBulbSize","_tileSize","_emission","_bulbSize","_updateUniforms","stop","deleteProgram","gl","program","_createWebGLProgram","useProgram","_bindAttributes","_bindUniforms","texture","init","width","clientWidth","height","clientHeight","cancelAnimationFrame","upload","viewport","drawingBufferWidth","drawingBufferHeight","clear","COLOR_BUFFER_BIT","drawArrays","TRIANGLES","bindTexture","TEXTURE_2D","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","createProgram","vs","_compileShader","signboardVS","VERTEX_SHADER","fs","signboardFS","FRAGMENT_SHADER","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","positionLocation","getAttribLocation","texcoordLocation","positionBuffer","createBuffer","texcoordBuffer","enableVertexAttribArray","bindBuffer","ARRAY_BUFFER","bufferData","ATTRIBUTE","STATIC_DRAW","vertexAttribPointer","FLOAT","getUniformLocation","uniforms","uniform1f","uniform2f","CONTENT_TYPE","IMAGE","VIDEO","image","_image","createTexture","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","texImage2D","RGBA","UNSIGNED_BYTE","video","_video","play","_src","_type","Promise","_loadImage","_loadVideo","Image","resolve","reject","ImageTexture","crossOrigin","createElement","VideoTexture","loop","playsInline","load","_b","_c","contentType","_d","_e","autoResize","_f","_g","_h","_renderer","Renderer","_initialized","_contentType","_autoResize","resize","bind","_updateAutoResize","renderer","textureLoader","TextureLoader","setTexture","start","newVal","prevVal","window","SignBoard","Core","Texture","Constants"],"mappings":"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"}